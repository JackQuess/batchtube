{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "sh -c 'ENTRY=${SERVICE_ENTRY:-server}; if [ \"$ENTRY\" = \"worker\" ]; then if [ ! -f \"dist/queues/worker.js\" ]; then npm run build; fi; node dist/queues/worker.js; else npm run prisma:generate && npm run prisma:migrate && if [ ! -f \"dist/server.js\" ]; then npm run build; fi && node dist/server.js; fi'"
  }
}
